{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AI/Documents/GitHub/MoStar-Grid/frontend/src/lib/api.ts"],"sourcesContent":["// API Types matching backend models\r\nexport interface GridEvent {\r\n    event_type: string;\r\n    source_agent: string;\r\n    location: string;\r\n    data: Record<string, any>;\r\n    priority?: string;\r\n}\r\n\r\nexport interface GridResponse {\r\n    event_id: string;\r\n    status: string;\r\n    resonance_score: number;\r\n    woo_judgment: string;\r\n}\r\n\r\nexport interface SystemHealth {\r\n    status: string;\r\n    db: {\r\n        connected: boolean;\r\n        pool_min: number | null;\r\n        pool_max: number | null;\r\n    };\r\n    consciousness: {\r\n        active_nodes: number;\r\n        coherence: number;\r\n        consciousness_uploads: number;\r\n    };\r\n}\r\n\r\n// API Client class\r\nexport class GridAPI {\r\n    private baseUrl: string;\r\n\r\n    constructor() {\r\n        this.baseUrl = (process.env.NEXT_PUBLIC_BACKEND_URL as string) || 'http://localhost:7000';\r\n    }\r\n\r\n    async health(): Promise<SystemHealth> {\r\n        try {\r\n            const response = await fetch(`${this.baseUrl.replace(/\\/$/, '')}/health`, { credentials: 'same-origin' });\r\n            if (!response.ok) {\r\n                const text = await response.text().catch(()=>null);\r\n                throw new Error(`Backend responded ${response.status}: ${text || response.statusText}`);\r\n            }\r\n            return await response.json();\r\n        } catch (err: any) {\r\n            // Provide a clearer error for the caller/UI\r\n            const msg = err?.message ? err.message : String(err);\r\n            console.error('GridAPI.health error:', msg);\r\n            throw new Error(`Network error when contacting backend (${this.baseUrl}): ${msg}`);\r\n        }\r\n    }\r\n\r\n    async submitEvent(event: GridEvent): Promise<GridResponse> {\r\n        try {\r\n            const response = await fetch(`${this.baseUrl.replace(/\\/$/, '')}/events`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(event),\r\n                credentials: 'same-origin'\r\n            });\r\n            if (!response.ok) {\r\n                const text = await response.text().catch(()=>null);\r\n                throw new Error(`Backend responded ${response.status}: ${text || response.statusText}`);\r\n            }\r\n            return await response.json();\r\n        } catch (err: any) {\r\n            const msg = err?.message ? err.message : String(err);\r\n            console.error('GridAPI.submitEvent error:', msg);\r\n            throw new Error(`Failed to submit event: ${msg}`);\r\n        }\r\n    }\r\n\r\n    async generateData(params: {\r\n        size?: number;\r\n        batch_size?: number;\r\n        scenario?: string;\r\n        load_db?: boolean;\r\n        truncate?: boolean;\r\n        export?: boolean;\r\n    }): Promise<{status: string; cmd: string}> {\r\n        try {\r\n            const response = await fetch(`${this.baseUrl.replace(/\\/$/, '')}/api/generate-synthetic-data`, {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(params)\r\n            });\r\n            if (!response.ok) {\r\n                const text = await response.text().catch(()=>null);\r\n                throw new Error(`Backend responded ${response.status}: ${text || response.statusText}`);\r\n            }\r\n            return await response.json();\r\n        } catch (err: any) {\r\n            console.error('GridAPI.generateData error:', err?.message ?? err);\r\n            throw err;\r\n        }\r\n    }\r\n\r\n    connectWebSocket(): WebSocket {\r\n        // Choose ws or wss based on baseUrl protocol\r\n        try {\r\n            const url = new URL(this.baseUrl);\r\n            const protocol = url.protocol === 'https:' ? 'wss:' : 'ws:';\r\n            const host = url.host;\r\n            const wsUrl = `${protocol}//${host}/ws/live-stream`;\r\n            return new WebSocket(wsUrl);\r\n        } catch (err) {\r\n            // Fallback to ws with host-only\r\n            const host = (this.baseUrl.replace(/^https?:\\/\\//, '')).replace(/\\/$/, '');\r\n            return new WebSocket(`ws://${host}/ws/live-stream`);\r\n        }\r\n    }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/AI/Documents/GitHub/MoStar-Grid/frontend/src/pages/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\nimport { GridAPI, SystemHealth } from '../lib/api';\r\n\r\nexport default function Dashboard() {\r\n  const [health, setHealth] = useState<SystemHealth | null>(null);\r\n  const [messages, setMessages] = useState<string[]>([]);\r\n  const api = new GridAPI();\r\n\r\n  useEffect(() => {\r\n    // Poll health endpoint\r\n    const pollHealth = async () => {\r\n      try {\r\n        const data = await api.health();\r\n        setHealth(data);\r\n      } catch (error) {\r\n        console.error('Health check failed:', error);\r\n      }\r\n    };\r\n    pollHealth();\r\n    const interval = setInterval(pollHealth, 5000);\r\n    \r\n    // Setup WebSocket\r\n    const ws = api.connectWebSocket();\r\n    ws.onmessage = (event) => {\r\n      setMessages(prev => [...prev, event.data].slice(-50));\r\n    };\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n      ws.close();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white\">\r\n      <header className=\"border-b border-gray-800 p-4\">\r\n        <h1 className=\"text-2xl font-bold\">MoStar GRID</h1>\r\n        <p className=\"text-gray-400\">First African AI Homeworld</p>\r\n      </header>\r\n\r\n      <main className=\"p-4\">\r\n        {/* System Status */}\r\n        <section className=\"mb-8\">\r\n          <h2 className=\"text-xl mb-4\">System Status</h2>\r\n          {health && (\r\n            <div className=\"grid grid-cols-3 gap-4\">\r\n              <div className=\"bg-gray-800 p-4 rounded\">\r\n                <h3>Active Nodes</h3>\r\n                <p className=\"text-2xl\">{health.consciousness.active_nodes}</p>\r\n              </div>\r\n              <div className=\"bg-gray-800 p-4 rounded\">\r\n                <h3>Coherence</h3>\r\n                <p className=\"text-2xl\">{health.consciousness.coherence.toFixed(4)}</p>\r\n              </div>\r\n              <div className=\"bg-gray-800 p-4 rounded\">\r\n                <h3>Events</h3>\r\n                <p className=\"text-2xl\">{health.consciousness.consciousness_uploads}</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </section>\r\n\r\n        {/* Live Stream */}\r\n        <section>\r\n          <h2 className=\"text-xl mb-4\">Live Stream</h2>\r\n          <div className=\"bg-gray-800 p-4 rounded h-64 overflow-y-auto\">\r\n            {messages.map((msg, i) => (\r\n              <div key={i} className=\"text-sm text-gray-300 mb-1\">{msg}</div>\r\n            ))}\r\n          </div>\r\n        </section>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAEe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAsB;IAC1D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,+GAAQ,EAAW,EAAE;IACrD,MAAM,MAAM,IAAI,0KAAO;IAEvB,IAAA,gHAAS,EAAC;QACR,uBAAuB;QACvB,MAAM,aAAa;YACjB,IAAI;gBACF,MAAM,OAAO,MAAM,IAAI,MAAM;gBAC7B,UAAU;YACZ,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,wBAAwB;YACxC;QACF;QACA;QACA,MAAM,WAAW,YAAY,YAAY;QAEzC,kBAAkB;QAClB,MAAM,KAAK,IAAI,gBAAgB;QAC/B,GAAG,SAAS,GAAG,CAAC;YACd,YAAY,CAAA,OAAQ;uBAAI;oBAAM,MAAM,IAAI;iBAAC,CAAC,KAAK,CAAC,CAAC;QACnD;QAEA,OAAO;YACL,cAAc;YACd,GAAG,KAAK;QACV;IACF,GAAG,EAAE;IAEL,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAO,WAAU;;kCAChB,qKAAC;wBAAG,WAAU;kCAAqB;;;;;;kCACnC,qKAAC;wBAAE,WAAU;kCAAgB;;;;;;;;;;;;0BAG/B,qKAAC;gBAAK,WAAU;;kCAEd,qKAAC;wBAAQ,WAAU;;0CACjB,qKAAC;gCAAG,WAAU;0CAAe;;;;;;4BAC5B,wBACC,qKAAC;gCAAI,WAAU;;kDACb,qKAAC;wCAAI,WAAU;;0DACb,qKAAC;0DAAG;;;;;;0DACJ,qKAAC;gDAAE,WAAU;0DAAY,OAAO,aAAa,CAAC,YAAY;;;;;;;;;;;;kDAE5D,qKAAC;wCAAI,WAAU;;0DACb,qKAAC;0DAAG;;;;;;0DACJ,qKAAC;gDAAE,WAAU;0DAAY,OAAO,aAAa,CAAC,SAAS,CAAC,OAAO,CAAC;;;;;;;;;;;;kDAElE,qKAAC;wCAAI,WAAU;;0DACb,qKAAC;0DAAG;;;;;;0DACJ,qKAAC;gDAAE,WAAU;0DAAY,OAAO,aAAa,CAAC,qBAAqB;;;;;;;;;;;;;;;;;;;;;;;;kCAO3E,qKAAC;;0CACC,qKAAC;gCAAG,WAAU;0CAAe;;;;;;0CAC7B,qKAAC;gCAAI,WAAU;0CACZ,SAAS,GAAG,CAAC,CAAC,KAAK,kBAClB,qKAAC;wCAAY,WAAU;kDAA8B;uCAA3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxB","debugId":null}}]
}